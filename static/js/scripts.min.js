function initialize(){null!=localStorage.getItem("token")&&getMe()}function login(){var e=document.getElementById("email").value,t=document.getElementById("password").value;""!=e&&""!=t?$.post("/api/auth",{email:e,password:t}).done(function(e){e.isSuccess?(localStorage.setItem("token",e.token),getMe(),$("#loginModal").modal("hide"),closeLoginModal()):console.log(e.message)}).fail(function(){console.log("login error")}):console.log("Missing values")}function logout(){localStorage.clear(),x=document.getElementById("loggedOutPanel"),x.style.display="block",x=document.getElementById("loggedInPanel"),x.style.display="none",x=document.getElementById("addEvent"),x.style.display="none",x=document.getElementById("addEventItem"),x.style.display="none",$("#logoutModal").modal("hide")}function signup(){var e=document.getElementById("name").value,t=document.getElementById("mail").value,o=document.getElementById("pwd").value,n=document.getElementById("repwd").value;""!=e&&""!=t&&""!=o&&""!=n?o==n?$.post("/api/auth/register",{name:e,email:t,password:o,repassword:n}).done(function(e){console.log(e),e.isSuccess?$.post("/api/auth",{email:t,password:o}).done(function(e){e.isSuccess?(localStorage.setItem("token",e.token),getMe(),$("#signupModal").modal("hide"),closeSignupModal()):console.log(e.message)}).fail(function(){console.log("login error")}):console.log(e.message)}).fail(function(){console.log("register error")}):console.log("Control your password."):console.log("Missing values.")}function getMe(){$.ajax({type:"GET",url:"api/auth/me",headers:{authorization:localStorage.getItem("token")},contentType:"application/json; charset=utf-8",success:function(e){if(e.isSuccess){localStorage.setItem("id",e.data.id),localStorage.setItem("name",e.data.name),document.getElementById("username").innerHTML=e.data.name;var t=document.getElementById("addEvent");t.style.display="block",(t=document.getElementById("addEventItem")).style.display="inline",(t=document.getElementById("loggedOutPanel")).style.display="none",(t=document.getElementById("loggedInPanel")).style.display="block"}},error:function(e){console.log(e)}})}function getStatistics(){}function getCategories(){}function getEvents(){}function getEventDetail(e){console.log(e),$.get("/api/eventDetail/"+e).done(function(e){console.log(e);var t="none";console.log(localStorage.getItem("id")),e.data.userId==localStorage.getItem("id")&&(t="block"),content='<div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">'+e.data.title+'</h4></div><div class="modal-body"><img class="col-12 col-md-4" src="'+e.data.photo+'" alt="image"><p style="font-weight: bold; font-size: 20px; margin:0">'+e.data.title+"-"+e.data.userName+'</p><p style="margin:0">'+e.data.start+'</p><p style="margin:0">'+e.data.address+'</p><div col-12 col-md-12><p style="margin: 10px; margin-top: 30px">'+e.data.content+'</p></div></div><div class="modal-footer"><button type="button" class="btn btn-danger btn-default pull-left" style="margin-left: 10px; display: '+t+'" onclick="deleteEvent(\''+e.data.id+'\');"><span class="glyphicon glyphicon-trash"></span> Delete</button><button type="submit" class="btn btn-primary btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button></div>',document.getElementById("eventDetail").innerHTML=content,$("#eventDetailModal").modal()})}function deleteEvent(e){console.log(localStorage.getItem("token")),$.ajax({type:"POST",url:"api/events/"+e,headers:{authorization:localStorage.getItem("token")},contentType:"application/json; charset=utf-8",success:function(e){e.isSuccess?(console.log(e.message),$("#eventDetailModal").modal("hide"),getEvents()):console.log(e.message)},error:function(e){console.log(e)}})}function addEvent(){var e=document.getElementById("eventName").value,t=document.getElementById("date").value,o=document.getElementById("city").value,n=document.getElementById("town").value,l=document.getElementById("fullAddress").value,a=document.getElementById("photo").files[0],s=document.getElementById("content").value,d=document.getElementById("category").value,c=$("#category option:selected").text();if(""!=e&&""!=date&&""!=o&&""!=n){var i=new FormData;i.append("File",a),$.ajax({url:"https://evantapp.azurewebsites.net/api/events/photo",type:"POST",data:i,cache:!1,contentType:!1,processData:!1,success:function(i){a=i.message;var g={title:e,start:t,city:o,town:n,fullAddress:l,photo:a,content:s,user:{id:localStorage.getItem("id"),userName:localStorage.getItem("name")},category:{id:d,categoryName:c}};$.post("/api/events",g).done(function(e){e.isSuccess?(console.log(e.message),getEvents()):console.log(e.message)}).fail(function(){console.log("add event error")})},error:function(e,t,o){console.log(o)}})}else console.log("Missing values.")}function closeLoginModal(){document.getElementById("email").value="",document.getElementById("password").value=""}function closeSignupModal(){document.getElementById("name").value="",document.getElementById("mail").value="",document.getElementById("pwd").value="",document.getElementById("repwd").value=""}initialize(),getEvents(),getStatistics(),getCategories();